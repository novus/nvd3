<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="../build/nv.d3.js"></script>
    <script src="lib/stream_layers.js"></script>

    <style>
        text {
            font: 12px sans-serif;
        }

        svg {
            display: block;
        }

        html, body, #chart1, svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body class='with-3d-shadow with-transitions'>

<div id="chart1">
    <svg></svg>
</div>

<script>

    var testdata = [
        {
            "key": "Cost",
            "bar": true,
            "values": [
                [
                    "2016-01",
                    12356.241842247584
                ],
                [
                    "2016-02",
                    2391.1221445777423
                ],
                [
                    "2016-03",
                    2731.4732919163907
                ],
                [
                    "2016-04",
                    9485.799162585774
                ],
                [
                    "2016-05",
                    11657.623194213471
                ],
                [
                    "2016-06",
                    9955.513917946602
                ],
                [
                    "2016-07",
                    10139.957267394448
                ],
                [
                    "2016-08",
                    8229.014335608517
                ],
                [
                    "2016-09",
                    17806.687851805906
                ],
                [
                    "2016-10",
                    6658.811243893693
                ],
                [
                    "2016-11",
                    6454.627990602533
                ],
                [
                    "2016-12",
                    null
                ],
                [
                    "2017-01",
                    null
                ],
                [
                    "2017-02",
                    null
                ],
                [
                    "2017-03",
                    null
                ],
                [
                    "2017-04",
                    null
                ],
                [
                    "2017-05",
                    null
                ],
                [
                    "2017-06",
                    null
                ],
                [
                    "2017-07",
                    null
                ],
                [
                    "2017-08",
                    null
                ],
                [
                    "2017-09",
                    null
                ],
                [
                    "2017-10",
                    null
                ],
                [
                    "2017-11",
                    null
                ],
                [
                    "2017-12",
                    null
                ]
            ]
        },
        {
            "key": "forecast",
            "bar": true,
            "values": [
                [
                    "2016-01",
                    null
                ],
                [
                    "2016-02",
                    null
                ],
                [
                    "2016-03",
                    null
                ],
                [
                    "2016-04",
                    null
                ],
                [
                    "2016-05",
                    null
                ],
                [
                    "2016-06",
                    null
                ],
                [
                    "2016-07",
                    null
                ],
                [
                    "2016-08",
                    null
                ],
                [
                    "2016-09",
                    null
                ],
                [
                    "2016-10",
                    null
                ],
                [
                    "2016-11",
                    6454.627990602533
                ],
                [
                    "2016-12",
                    11226.934
                ],
                [
                    "2017-01",
                    9433.1109
                ],
                [
                    "2017-02",
                    7639.2877
                ],
                [
                    "2017-03",
                    5845.4646
                ],
                [
                    "2017-04",
                    4051.6414
                ],
                [
                    "2017-05",
                    2257.8183
                ],
                [
                    "2017-06",
                    463.9952
                ],
                [
                    "2017-07",
                    0.0
                ],
                [
                    "2017-08",
                    0.0
                ],
                [
                    "2017-09",
                    0.0
                ],
                [
                    "2017-10",
                    0.0
                ],
                [
                    "2017-11",
                    null
                ],
                [
                    "2017-12",
                    null
                ]
            ]
        },
        {
            "key": "Budget",
            "values": [
                [
                    "2016-01",
                    12083.3333333333335
                ],
                [
                    "2016-12",
                    12083.3333333333335
                ],
                [
                    "2017-03",
                    12083.3333333333335
                ],
                [
                    "2016-11",
                    12083.3333333333335
                ],
                [
                    "2017-04",
                    12083.3333333333335
                ],
                [
                    "2016-10",
                    12083.3333333333335
                ],
                [
                    "2017-05",
                    12083.3333333333335
                ],
                [
                    "2017-06",
                    12083.3333333333335
                ],
                [
                    "2016-05",
                    12083.3333333333335
                ],
                [
                    "2017-10",
                    12083.3333333333335
                ],
                [
                    "2016-04",
                    12083.3333333333335
                ],
                [
                    "2017-11",
                    12083.3333333333335
                ],
                [
                    "2016-03",
                    12083.3333333333335
                ],
                [
                    "2017-01",
                    12083.3333333333335
                ],
                [
                    "2017-12",
                    12083.3333333333335
                ],
                [
                    "2016-02",
                    12083.3333333333335
                ],
                [
                    "2017-02",
                    12083.3333333333335
                ],
                [
                    "2016-09",
                    12083.3333333333335
                ],
                [
                    "2016-08",
                    12083.3333333333335
                ],
                [
                    "2016-07",
                    12083.3333333333335
                ],
                [
                    "2016-06",
                    12083.3333333333335
                ],
                [
                    "2017-07",
                    12083.3333333333335
                ],
                [
                    "2017-08",
                    12083.3333333333335
                ],
                [
                    "2017-09",
                    12083.3333333333335
                ]
            ]
        }
    ];

    testdata[0].type = "bar";
    testdata[0].yAxis = 1;
    testdata[1].type = "bar";
    testdata[1].yAxis = 2;
    testdata[2].type = "line";
    testdata[2].yAxis = 1;


    testdata = testdata.slice(0, 3);

    nv.addGraph(function () {
        var chart = nv.models.multiChart();

        chart.margin({top: 30, right: 60, bottom: 50, left: 70})
            .color(d3.scale.category10().range())
            .x(function (d) {
                var label = d.label;

                return new Date(d[0]).getTime();
            })
            .y(function(d) {
                return d[1]
            })
            .barsModel(nv.models.historicalBar)
            .xScale(d3.time.scale())
        ;

        chart.xAxis.tickFormat(function (d, i, e) {
            return new Date(d).getMonth() + '.' + new Date(d).getFullYear();
        });

        chart.yDomain2([0, 20000]);
        chart.yDomain1([0, 20000]);

        d3.select('#chart1 svg')
            .datum(testdata)
            .transition().duration(500).call(chart);

        return chart;
    });

</script>
</body>
</html>
